# 2.3 - Deploy Imagem de registry externo

[Permalink](https://github.com/redhatbsb/test-drive-openshift/blob/8ce43c5cb511571d907947f2d78a595d00910586/parte-2-openshift-4x/deploy-imagem-external-registry.adoc)

Cannot retrieve contributors at this time

 119 lines \(73 sloc\) 3.91 KB

## Deploy imagem do Docker Hub <a id="user-content-deploy-imagem-do-docker-hub"></a>

### Introdução <a id="user-content-introdu&#xE7;&#xE3;o"></a>

Vamos agora implantar uma imagem existente no [Quay](http://quay.io/). O Quay é um registry externo semelhante ao [Docker Hub](https://hub.docker.com/).

A imagem que vamos utilizar, foi criada usando Java e o framework [Quarkus](https://quarkus.io/). Ela é extremamente pequena e roda consumindo poucos recursos.

Para executar a imagem no Openshift, siga os passos abaixo:

### Usando uma imagem do Quarkus <a id="user-content-escolha-a-imagem"></a>

#### Deploy pela Web Console <a id="user-content-deploy-web-console"></a>

Utilizaremos a imagem do exemplo abaixo:

```text
quay.io/gluszczy/workshop-openshift
```

Para criar um container com base em uma image externa ao Openshift, selecione a opção de `Container Image` conforme imagem abaixo:

Depois preencha o campo `Image name from external registry` com o valor da sua imagem, no nosso caso o valor é `quay.io/gluszczy/workshop-openshift`. Logo em seguida, tire o foco \(cursor\) do campo da imagem e ele irá validar se o dado informado está correto.

Agora deixe todos os campos com os valores padrão e clique em `Create` no fim da tela.

Agora, na tela de topologia, você deve ser a seguinte imagem:

#### Deploy pela CLI <a id="user-content-deploy-cli"></a>

Caso queira usar a linha de comando, execute:

```text
oc new-app --docker-image=quay.io/gluszczy/workshop-openshift --name=workshop-openshift
```

Agora crie a rota da sua aplicação com o comando:

```text
oc expose svc workshop-openshift
```

Agora, na tela de topologia, você deve ser a seguinte imagem:

#### Limpeza do ambiente <a id="user-content-limpeza-do-ambiente"></a>

Caso você tenha errado na criação da sua aplicação nos passos anteriores, para deletá-la execute o seguinte comando no terminal:

| Warning |  Só delete a aplicação caso tenha acontecido algum problema na criação da sua aplicação |
| :--- | :--- |


```text
oc delete all -l app=workshop-openshift
```

Se você deletou sua aplicação, pode criá-la novamente [usando o CLI]() ou a [Web Console]() conforme já mostrado nos passos anteriores

### Explorando a Web Console <a id="user-content-explorando-a-gui-do-pod"></a>

#### App Resources <a id="user-content-app-resources"></a>

Para ver a nossa aplicação recém-criada, clique no menu lateral esquerdo em `Topology`.

Você verá sua aplicação no centro da tela.

1. Por meio dessa parte você tem acesso aos dados do `Pod`
2. Caso o Openshift faça o `Build` da sua imagem, seria exibido nessa parte.
3. O `Service` faz o balanceamento interno entre os containers e também serve como uma camada de `service discovery`
4. Um objeto `Route` permite acesso externo a sua aplicação

#### App Overview <a id="user-content-app-overview"></a>

Na tela de overview você tem uma visão geral da sua aplicação. Nela você pode ver quantos pods estão rodando, qual a versão atual, qual projeto e labels utilizados e também outros detalhes de deployment dessa aplicação

### Imagem e Segurança <a id="user-content-imagem-e-seguran&#xE7;a"></a>

| Note |  Os detalhes abaixo não devem ser executados. Servem só para ilustrar como o Openshift lida com imagem que rodem como `root`. |
| :--- | :--- |


Se a imagem escolhida rodar como root, o Openshift te avisa na Web Console \(por meio de uma tarja laranja\) que ela pode eventualmente não executar conforme o esperado.

