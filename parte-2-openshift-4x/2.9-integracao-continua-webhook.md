# 2.9 - Integração contínua

[Permalink](https://github.com/redhatbsb/test-drive-openshift/blob/8ce43c5cb511571d907947f2d78a595d00910586/parte-2-openshift-4x/integracao-continua-webhook.adoc)**2** contributors

 [![@luszczynski](https://avatars.githubusercontent.com/u/3693884?s=48&v=4)](https://github.com/redhatbsb/test-drive-openshift/commits/v4.5/parte-2-openshift-4x/integracao-continua-webhook.adoc?author=luszczynski) [![@redhatbsb](https://avatars.githubusercontent.com/u/40247249?s=48&v=4)](https://github.com/redhatbsb/test-drive-openshift/commits/v4.5/parte-2-openshift-4x/integracao-continua-webhook.adoc?author=redhatbsb)

## Integração Contínua \(Webhook\) <a id="user-content-integra&#xE7;&#xE3;o-cont&#xED;nua-webhook"></a>

### Introdução <a id="user-content-introdu&#xE7;&#xE3;o"></a>

Podemos automatizar o processo de build do nosso container toda vez que for feito push no nosso repositório git. Para isso, iremos configurar um `webhook`. Por meio dele, o servidor git avisará o Openshift sempre que um commit \(push\) novo ocorrer.

### Configuração webhook <a id="user-content-configura&#xE7;&#xE3;o-webhook"></a>

Acesse a opcao `Builds` no menu esquerdo.

Depois selecione `workshop-ocp` ou equivalente

Role a tela abaixo e localize o webhook para GitHub

No _Github.com_:

* Selecione `Settings` no menu horizontal

[![image](https://raw.githubusercontent.com/guaxinim/test-drive-openshift/master/gitbook/assets/selection_258.png)](https://raw.githubusercontent.com/guaxinim/test-drive-openshift/master/gitbook/assets/selection_258.png)

* Selecione o `Webhooks` no menu lateral esquerdo

[![image](https://raw.githubusercontent.com/guaxinim/test-drive-openshift/master/gitbook/assets/selection_259.png)](https://raw.githubusercontent.com/guaxinim/test-drive-openshift/master/gitbook/assets/selection_259.png)

* Selecione `Add Webhooks`, cole a URL copiada no campo `Payload URL`, no campo `Content Type` selecione a opção `application/json`
* Clique em `Disable SSL verification`
* Finalize no botão `Add webhook`

[![image](https://raw.githubusercontent.com/guaxinim/test-drive-openshift/master/gitbook/assets/selection_088.png)](https://raw.githubusercontent.com/guaxinim/test-drive-openshift/master/gitbook/assets/selection_088.png)

### Altere a aplicação <a id="user-content-altere-a-aplica&#xE7;&#xE3;o"></a>

#### Usando a Web Console <a id="user-content-usando-a-web-console"></a>

Para fazermos uma alteração na aplicação, vamos alterar a versão na página inicial da aplicação.

Clique no `Index.php`

[![image](https://raw.githubusercontent.com/guaxinim/test-drive-openshift/master/gitbook/assets/selection_265.png)](https://raw.githubusercontent.com/guaxinim/test-drive-openshift/master/gitbook/assets/selection_265.png)

Depois clique no lápis para editar

[![image](https://raw.githubusercontent.com/guaxinim/test-drive-openshift/master/gitbook/assets/selection_266.png)](https://raw.githubusercontent.com/guaxinim/test-drive-openshift/master/gitbook/assets/selection_266.png)

No `index.php`, altere a linha com a versão da aplicação para versão 2.0.

[![image](https://raw.githubusercontent.com/guaxinim/test-drive-openshift/master/gitbook/assets/selection_268.png)](https://raw.githubusercontent.com/guaxinim/test-drive-openshift/master/gitbook/assets/selection_268.png)

```text
echo "Openshift Workshop v2.0";
```

Clique em `Commit changes`

[![image](https://raw.githubusercontent.com/guaxinim/test-drive-openshift/master/gitbook/assets/selection_269.png)](https://raw.githubusercontent.com/guaxinim/test-drive-openshift/master/gitbook/assets/selection_269.png)

#### Usando a linha de comando <a id="user-content-usando-a-linha-de-comando"></a>

Podemos fazer o processo de commit e push por meio da linha de comando do git:

```text
git add index.php
git commit -m "webhook adicionado"
git push
```

### Acompanhe o rolling deployment <a id="user-content-acompanhe-o-rolling-deployment"></a>

Após o commit ter sido feito, repare que um novo build é iniciado automaticamente sem interveção nossa. Isso pode ser visto pela imagem:

Observe também que não ocorre indisponibilidade durante a troca de versão.

